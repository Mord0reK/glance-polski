{{ template "widget-base.html" . }}

{{- define "widget-content" }}
<style>
    .cloudflare-select {
        appearance: none;
        background-color: var(--color-widget-background-highlight);
        border: 1px solid var(--color-widget-content-border);
        border-radius: var(--border-radius);
        color: var(--color-text-base);
        padding: 0.2rem 0.6rem;
        font-size: var(--font-size-h6);
        cursor: pointer;
        outline: none;
        transition: border-color 0.2s;
    }
    .cloudflare-select:hover {
        border-color: var(--color-text-subdue);
    }
    .cloudflare-select:focus {
        border-color: var(--color-primary);
    }
    
    .chart-tooltip {
        position: absolute;
        background: var(--color-popover-background);
        border: 1px solid var(--color-popover-border);
        border-radius: var(--border-radius);
        padding: 0.5rem;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.1s;
        z-index: 10;
        font-size: var(--font-size-h6);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        white-space: nowrap;
    }
    
    .chart-cursor {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 1px;
        background-color: var(--color-text-subdue);
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.1s;
    }
</style>

<div class="flex flex-column relative" data-widget-id="{{ .GetID }}">
    <script type="application/json" class="cloudflare-data">
        {{ .Data.Series | json }}
    </script>

    <div class="flex justify-end margin-bottom-1">
        <select class="cloudflare-select cloudflare-time-range">
            <option value="24h" {{ if eq .TimeRange "24h" }}selected{{ end }}>Last 24h</option>
            <option value="7d" {{ if eq .TimeRange "7d" }}selected{{ end }}>Last 7d</option>
            <option value="30d" {{ if eq .TimeRange "30d" }}selected{{ end }}>Last 30d</option>
        </select>
    </div>

    <div class="chart-container relative" style="height: 80px; width: 100%; margin-bottom: 0.5rem; cursor: crosshair;">
        <div class="chart-cursor"></div>
        <div class="chart-tooltip"></div>
        <svg viewBox="0 0 100 50" preserveAspectRatio="none" width="100%" height="100%">
            <polyline
                fill="none"
                stroke="var(--color-primary)"
                stroke-width="2"
                points="{{ .Data.ChartPoints }}"
                vector-effect="non-scaling-stroke"
            />
        </svg>
    </div>
    
    <div class="relative" style="height: 1.5rem; margin-top: -0.25rem; margin-bottom: 1.5rem; margin-right: 10px;">
        {{ range .Data.AxisLabels }}
        <div class="text-compact color-subdue" style="position: absolute; left: {{ .Left }}%; transform: {{ .Transform }}; white-space: nowrap;">
            {{ .Label }}
        </div>
        {{ end }}
    </div>

    
    <div class="flex justify-between">
        <div>
            <div class="size-h3 color-highlight">{{ .Data.TotalRequests | formatNumber }}</div>
            <div class="text-label text-compact">Zapyta≈Ñ</div>
        </div>
        <div class="text-right">
            <div class="size-h3 color-highlight">{{ .Data.UniqueVisitors | formatNumber }}</div>
            <div class="text-label text-compact">Unikalnych</div>
        </div>
    </div>
</div>
{{- end }}
