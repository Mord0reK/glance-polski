{{ template "widget-base.html" . }}

{{- define "widget-content" }}
{{- $redirect := .RedirectURL }}
{{- range .Systems }}
<div class="server">
    <div class="server-info">
        <div class="server-details">
            <div class="server-name size-h3">
                {{ if ne $redirect "" }}
                <a class="color-highlight" href="{{ $redirect }}/system/{{ .Name }}" target="_blank" rel="noopener">{{ .Name }}</a>
                {{ else }}
                <span class="color-highlight">{{ .Name }}</span>
                {{ end }}
            </div>
            <div>
                {{ if eq .Status "up" }}
                    <span {{ dynamicRelativeTimeAttrs .BootTime }}></span> uptime
                {{ else }}
                    <span class="color-negative">down</span>
                {{ end }}
            </div>
        </div>
        <div class="shrink-0" data-popover-type="html" data-popover-margin="0.2rem" data-popover-max-width="400px">
            <div data-popover-html>
                <div class="size-h5 text-compact">HOST</div>
                <div class="color-highlight">{{ .Host }}</div>
                
                <div class="size-h5 text-compact margin-top-3">KERNEL</div>
                <div class="color-highlight">{{ .Info.Kernel }}</div>

                <div class="size-h5 text-compact margin-top-3">CPU MODEL</div>
                <div class="color-highlight">{{ .Info.CPUModel }}</div>
            </div>
            <svg class="server-icon" stroke="var(--color-{{ if eq .Status "up" }}positive{{ else }}negative{{ end }})" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008v-.008Zm-3 0h.008v.008h-.008v-.008Z" />
            </svg>
        </div>
    </div>
    <div class="server-stats">
        <div class="flex-1">
            <div class="flex items-end size-h5">
                <div>CPU</div>
                <div class="color-highlight margin-left-auto text-very-compact">{{ printf "%.1f" .Info.CPU }} <span class="color-base">%</span></div>
            </div>
            <div class="progress-bar" data-popover-type="html">
                <div data-popover-html>
                    <div class="flex">
                        <div class="size-h5">1M AVG</div>
                        <div class="value-separator"></div>
                        <div class="color-highlight text-very-compact">{{ .Info.Load1 }}</div>
                    </div>
                    <div class="flex margin-top-3">
                        <div class="size-h5">5M AVG</div>
                        <div class="value-separator"></div>
                        <div class="color-highlight text-very-compact">{{ .Info.Load5 }}</div>
                    </div>
                    <div class="flex margin-top-3">
                        <div class="size-h5">15M AVG</div>
                        <div class="value-separator"></div>
                        <div class="color-highlight text-very-compact">{{ .Info.Load15 }}</div>
                    </div>
                </div>
                <div class="progress-value{{ if ge .Info.CPU 85.0 }} progress-value-notice{{ end }}" style="--percent: {{ .Info.CPU }}"></div>
            </div>
        </div>
        <div class="flex-1">
            <div class="flex items-end size-h5">
                <div>RAM</div>
                <div class="color-highlight margin-left-auto text-very-compact">{{ printf "%.1f" .Info.Memory }} <span class="color-base">%</span></div>
            </div>
            <div class="progress-bar">
                <div class="progress-value{{ if ge .Info.Memory 85.0 }} progress-value-notice{{ end }}" style="--percent: {{ .Info.Memory }}"></div>
            </div>
        </div>
        <div class="flex-1">
            <div class="flex items-end size-h5">
                <div>DISK</div>
                <div class="color-highlight margin-left-auto text-very-compact">{{ printf "%.1f" .Info.Disk }} <span class="color-base">%</span></div>
            </div>
            <div class="progress-bar">
                <div class="progress-value{{ if ge .Info.Disk 85.0 }} progress-value-notice{{ end }}" style="--percent: {{ .Info.Disk }}"></div>
            </div>
        </div>
    </div>
</div>
{{- end }}
{{- end }}
